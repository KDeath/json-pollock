<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8>
  <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8.1.3/dist/polyfill.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js"></script>
  <script>
    /* eslint-disable */
    // var PLAYGROUND_SERVICE_API = 'https://json-pollock-service.herokuapp.com/api/';
    var PLAYGROUND_SERVICE_API = 'http://localhost:5000/api/';

    function getUrlParam(paramName) {
      var params = window.location.search.substring(1).split('&');
      var param = params.filter(function(p){
        return p && p.indexOf(paramName) === 0;
      });

      return param.length ? param[0].split('=')[1] : '';
    }

    var state = getUrlParam('state');
    var code = getUrlParam('code');

    fetch(PLAYGROUND_SERVICE_API + 'rate_limit')
    .then(response => response.json())
    .then(data => console.log(data));

    fetch(PLAYGROUND_SERVICE_API + 'access_token', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        code: code,
        state: state
      })
    })
    .then(response => response.json())
    .then(data => {
      window.opener.postMessage(data.access_token, window.location);
      window.close();
    })
  .catch((error) => {
    console.error('Error:', error);
  });
  </script>
  <link rel=icon type=image/png href=/json-pollock/src/assets/logo.png>
  <title>JsonPollock Playground Login page</title>
</head>

<body>
  </body>
</html>
